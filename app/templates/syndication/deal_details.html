{% extends "base.html" %}

{% block title %}{{ deal.title }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl font-bold mb-8" data-aos="fade-down">{{ deal.title }}</h1>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Deal Overview -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-lg shadow-md p-6 mb-8" data-aos="fade-up">
                <h2 class="text-2xl font-semibold mb-4">Deal Overview</h2>
                <p class="text-gray-600 mb-4">{{ deal.description }}</p>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p class="font-semibold">Target Amount:</p>
                        <p class="text-2xl text-green-600">${{ "%.2f"|format(deal.target_amount) }}</p>
                    </div>
                    <div>
                        <p class="font-semibold">Current Amount:</p>
                        <p class="text-2xl text-blue-600">${{ "%.2f"|format(deal.current_amount) }}</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p class="font-semibold mb-2">Progress: {{ "%.2f"|format(deal.current_amount / deal.target_amount * 100) }}%</p>
                    <div class="w-full bg-gray-200 rounded-full h-4">
                        <div class="bg-blue-600 h-4 rounded-full" style="width: {{ deal.current_amount / deal.target_amount * 100 }}%"></div>
                    </div>
                </div>
            </div>

            <!-- Documents -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8" data-aos="fade-up" data-aos-delay="200">
                <h2 class="text-2xl font-semibold mb-4">Documents</h2>
                {% if deal.documents %}
                    <ul class="space-y-2">
                    {% for document in deal.documents %}
                        <li class="flex items-center justify-between">
                            <a href="{{ url_for('syndication.view_document', deal_id=deal.id, document_id=document.id) }}" class="text-blue-600 hover:underline">
                                {{ document.filename }}
                            </a>
                            <span class="text-gray-500 text-sm">{{ document.upload_date.strftime('%Y-%m-%d %H:%M') }}</span>
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-gray-500">No documents uploaded yet.</p>
                {% endif %}
            </div>
        </div>

        <!-- Sidebar -->
        <div class="space-y-8">
            <!-- Invest in this Deal -->
            <div class="bg-white rounded-lg shadow-md p-6" data-aos="fade-up" data-aos-delay="100">
                <h2 class="text-2xl font-semibold mb-4">Invest in this Deal</h2>
                <form action="{{ url_for('syndication.invest', deal_id=deal.id) }}" method="POST" class="space-y-4">
                    <div>
                        <label for="amount" class="block text-sm font-medium text-gray-700">Investment Amount ($)</label>
                        <input type="number" step="0.01" id="amount" name="amount" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    </div>
                    <button type="submit" class="w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition duration-300">Invest</button>
                </form>
            </div>

            <!-- Upload Document -->
            <div class="bg-white rounded-lg shadow-md p-6" data-aos="fade-up" data-aos-delay="200">
                <h2 class="text-2xl font-semibold mb-4">Upload Document</h2>
                <form action="{{ url_for('syndication.upload_document', deal_id=deal.id) }}" method="POST" enctype="multipart/form-data" class="space-y-4">
                    <div>
                        <label for="file" class="block text-sm font-medium text-gray-700">Select File</label>
                        <input type="file" id="file" name="file" required class="mt-1 block w-full">
                    </div>
                    <button type="submit" class="w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition duration-300">Upload</button>
                </form>
            </div>

            <!-- Share Deal -->
            <div class="bg-white rounded-lg shadow-md p-6" data-aos="fade-up" data-aos-delay="300">
                <h2 class="text-2xl font-semibold mb-4">Share Deal</h2>
                <form action="{{ url_for('syndication.share_deal', deal_id=deal.id) }}" method="POST" class="space-y-4">
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Recipient Email</label>
                        <input type="email" id="email" name="email" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    </div>
                    <button type="submit" class="w-full bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition duration-300">Share</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}